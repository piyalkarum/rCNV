<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate population-wise Vst — vst • rCNV</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate population-wise Vst — vst"><meta name="description" content="This function calculates Vst (variant fixation index) for populations given
a list of duplicated loci"><meta property="og:description" content="This function calculates Vst (variant fixation index) for populations given
a list of duplicated loci"><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rCNV</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.900</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/rCNV.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/piyalkarum/rCNV/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate population-wise Vst</h1>
      <small class="dont-index">Source: <a href="https://github.com/piyalkarum/rCNV/blob/HEAD/R/post_detect.R" class="external-link"><code>R/post_detect.R</code></a></small>
      <div class="d-none name"><code>vst.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates Vst (variant fixation index) for populations given
a list of duplicated loci</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vst</span><span class="op">(</span><span class="va">AD</span>, <span class="va">pops</span>, id.list <span class="op">=</span> <span class="cn">NULL</span>, qGraph <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ad">AD<a class="anchor" aria-label="anchor" href="#arg-ad"></a></dt>
<dd><p>data frame of total allele depth values of (duplicated, if
<code>id.list</code> is not provided) SNPs</p></dd>


<dt id="arg-pops">pops<a class="anchor" aria-label="anchor" href="#arg-pops"></a></dt>
<dd><p>character. A vector of population names for each individual.
Must be the same length as the number of samples in AD</p></dd>


<dt id="arg-id-list">id.list<a class="anchor" aria-label="anchor" href="#arg-id-list"></a></dt>
<dd><p>character. A vector of duplicated SNP IDs. Must match the IDs
in the AD data frame</p></dd>


<dt id="arg-qgraph">qGraph<a class="anchor" aria-label="anchor" href="#arg-qgraph"></a></dt>
<dd><p>logical. Plot the network plot based on Vst values
(see details)</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical. show progress</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to <code>qgraph</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a matrix of pairwise Vst values for populations</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Vst is calculated with the following equation
$$V_{T} = \frac{ V_{S} }{V_{T}}$$ where VT is the variance of normalized
read depths among all individuals from the two populations and VS is the
average of the variance within each population, weighed for population size
(see reference for more details)
See <code>qgraph</code> help for details on qgraph output</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Redon, Richard, et al. Global variation in copy number in the human genome.
nature 444.7118 (2006)</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Piyal Karunarathne</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">alleleINF</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ADtable</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DD</span><span class="op">&lt;-</span><span class="fu"><a href="dupGet.html">dupGet</a></span><span class="op">(</span><span class="va">alleleINF</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> categorizing deviant SNPs with </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  excess of heterozygotes z.all &amp; chi.all</span>
<span class="r-plt img"><img src="vst-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">ds</span><span class="op">&lt;-</span><span class="va">DD</span><span class="op">[</span><span class="va">DD</span><span class="op">$</span><span class="va">dup.stat</span><span class="op">==</span><span class="st">"deviant"</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">ad</span><span class="op">&lt;-</span><span class="va">ADtable</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ds</span><span class="op">$</span><span class="va">CHROM</span>,<span class="st">"."</span>,<span class="va">ds</span><span class="op">$</span><span class="va">POS</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ADtable</span><span class="op">$</span><span class="va">CHROM</span>,<span class="st">"."</span>,<span class="va">ADtable</span><span class="op">$</span><span class="va">POS</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">vst</span><span class="op">(</span><span class="va">ad</span>,pops<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ad</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="fl">1</span>,<span class="fl">11</span><span class="op">)</span><span class="op">)</span> <span class="co"># \dontrun{}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                          |                                                  |   0%  |                                                          |                                                  |   1%  |                                                          |=                                                 |   2%  |                                                          |=                                                 |   3%  |                                                          |==                                                |   4%  |                                                          |==                                                |   5%  |                                                          |===                                               |   6%  |                                                          |===                                               |   7%  |                                                          |====                                              |   8%  |                                                          |====                                              |   9%  |                                                          |=====                                             |  10%  |                                                          |======                                            |  11%  |                                                          |======                                            |  12%  |                                                          |=======                                           |  13%  |                                                          |=======                                           |  14%  |                                                          |========                                          |  15%  |                                                          |========                                          |  16%  |                                                          |=========                                         |  17%  |                                                          |=========                                         |  18%  |                                                          |==========                                        |  19%  |                                                          |==========                                        |  20%  |                                                          |==========                                        |  21%  |                                                          |===========                                       |  22%  |                                                          |===========                                       |  23%  |                                                          |============                                      |  24%  |                                                          |============                                      |  25%  |                                                          |=============                                     |  26%  |                                                          |=============                                     |  27%  |                                                          |==============                                    |  28%  |                                                          |==============                                    |  29%  |                                                          |===============                                   |  30%  |                                                          |================                                  |  31%  |                                                          |================                                  |  32%  |                                                          |=================                                 |  33%  |                                                          |=================                                 |  34%  |                                                          |==================                                |  35%  |                                                          |==================                                |  36%  |                                                          |===================                               |  37%  |                                                          |===================                               |  38%  |                                                          |====================                              |  39%  |                                                          |====================                              |  40%  |                                                          |====================                              |  41%  |                                                          |=====================                             |  42%  |                                                          |=====================                             |  43%  |                                                          |======================                            |  44%  |                                                          |======================                            |  45%  |                                                          |=======================                           |  46%  |                                                          |=======================                           |  47%  |                                                          |========================                          |  48%  |                                                          |========================                          |  49%  |                                                          |=========================                         |  50%  |                                                          |==========================                        |  51%  |                                                          |==========================                        |  52%  |                                                          |===========================                       |  53%  |                                                          |===========================                       |  54%  |                                                          |============================                      |  55%  |                                                          |============================                      |  56%  |                                                          |=============================                     |  57%  |                                                          |=============================                     |  58%  |                                                          |==============================                    |  59%  |                                                          |==============================                    |  60%  |                                                          |==============================                    |  61%  |                                                          |===============================                   |  62%  |                                                          |===============================                   |  63%  |                                                          |================================                  |  64%  |                                                          |================================                  |  65%  |                                                          |=================================                 |  66%  |                                                          |=================================                 |  67%  |                                                          |==================================                |  68%  |                                                          |==================================                |  69%  |                                                          |===================================               |  70%  |                                                          |====================================              |  71%  |                                                          |====================================              |  72%  |                                                          |=====================================             |  73%  |                                                          |=====================================             |  74%  |                                                          |======================================            |  75%  |                                                          |======================================            |  76%  |                                                          |=======================================           |  77%  |                                                          |=======================================           |  78%  |                                                          |========================================          |  79%  |                                                          |========================================          |  80%  |                                                          |========================================          |  81%  |                                                          |=========================================         |  82%  |                                                          |=========================================         |  83%  |                                                          |==========================================        |  84%  |                                                          |==========================================        |  85%  |                                                          |===========================================       |  86%  |                                                          |===========================================       |  87%  |                                                          |============================================      |  88%  |                                                          |============================================      |  89%  |                                                          |=============================================     |  90%  |                                                          |==============================================    |  91%  |                                                          |==============================================    |  92%  |                                                          |===============================================   |  93%  |                                                          |===============================================   |  94%  |                                                          |================================================  |  95%  |                                                          |================================================  |  96%  |                                                          |================================================= |  97%  |                                                          |================================================= |  98%  |                                                          |==================================================|  99%  |                                                          |==================================================| 100%</span>
<span class="r-plt img"><img src="vst-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             KKOGR07_000  KKOGR07_001  KKOGR07_002   KKOGR07_003  KKOGR07_004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_000          NA           NA           NA            NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_001 -0.05122414           NA           NA            NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_002 -0.04371113 -0.042496590           NA            NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_003 -0.02603668 -0.026878950 -0.022139367            NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_004 -0.01252776 -0.005286347 -0.009161007  0.0217061531           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_005 -0.04848016  0.001521456  0.004962315  0.0151247848  0.032953289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_006 -0.05562812 -0.014114825 -0.014535465  0.0077975184  0.015824418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_000  0.13616157  0.186596780  0.204152082  0.0869423330  0.256857888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_001 -0.05780229 -0.039294302 -0.035640345 -0.0310422447 -0.009366708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_002 -0.03738761 -0.016342567 -0.023458249 -0.0148268130 -0.001101267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_003 -0.02774479 -0.013764561 -0.012173887 -0.0150586122  0.019466392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_004 -0.02774910 -0.010272805 -0.016956333 -0.0193283672  0.027305690</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_005 -0.01881313  0.008650971  0.009339490 -0.0006875292  0.041958367</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_006  0.01223390  0.016782762  0.005973111  0.0373721639 -0.027712851</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_007 -0.04286858 -0.003037995 -0.015330106  0.0092210254  0.000359757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              KKOGR07_005  KKOGR07_006 KKOKT10_000  KKOKT10_001  KKOKT10_002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_000           NA           NA          NA           NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_001           NA           NA          NA           NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_002           NA           NA          NA           NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_003           NA           NA          NA           NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_004           NA           NA          NA           NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_005           NA           NA          NA           NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_006 -0.031420615           NA          NA           NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_000  0.245367293  0.275764500          NA           NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_001 -0.033006393 -0.032583610  0.07668781           NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_002  0.012029077 -0.001113533  0.17827212 -0.053217457           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_003  0.039989191  0.028427012  0.19380683 -0.051441882 -0.037921936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_004  0.033516110  0.018835012  0.14721069 -0.047534596 -0.031878762</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_005  0.053380978  0.044445648  0.15893253 -0.030200484 -0.005879087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_006  0.072861128  0.050073301  0.35024893 -0.006957781  0.003017883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_007  0.001646667 -0.029910661  0.30899688 -0.044790561 -0.023194798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               KKOKT10_003  KKOKT10_004 KKOKT10_005 KKOKT10_006 KKOKT10_007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_000            NA           NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_001            NA           NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_002            NA           NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_003            NA           NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_004            NA           NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_005            NA           NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_006            NA           NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_000            NA           NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_001            NA           NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_002            NA           NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_003            NA           NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_004 -0.0428280300           NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_005 -0.0177511147 -0.018142971          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_006  0.0196278521  0.035513265  0.06519210          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_007 -0.0001255767  0.003424613  0.02279381  0.00874942          NA</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Piyal Karunarathne, Qiujie Zhou, Klaus Schliep, Pascal Milesi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

