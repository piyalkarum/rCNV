<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function calculates Vst (variant fixation index) for populations given
a list of duplicated loci"><title>Calculate population-wise Vst — vst • rCNV</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate population-wise Vst — vst"><meta property="og:description" content="This function calculates Vst (variant fixation index) for populations given
a list of duplicated loci"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rCNV</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/rCNV.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/piyalkarum/rCNV/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate population-wise Vst</h1>
      <small class="dont-index">Source: <a href="https://github.com/piyalkarum/rCNV/blob/HEAD/R/post_detect.R" class="external-link"><code>R/post_detect.R</code></a></small>
      <div class="d-none name"><code>vst.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates Vst (variant fixation index) for populations given
a list of duplicated loci</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vst</span><span class="op">(</span><span class="va">AD</span>, <span class="va">pops</span>, id.list <span class="op">=</span> <span class="cn">NULL</span>, qGraph <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>AD</dt>
<dd><p>data frame of total allele depth values of (duplicated, if
<code>id.list</code> is not provided) SNPs</p></dd>


<dt>pops</dt>
<dd><p>character. A vector of population names for each individual.
Must be the same length as the number of samples in AD</p></dd>


<dt>id.list</dt>
<dd><p>character. A vector of duplicated SNP IDs. Must match the IDs
in the AD data frame</p></dd>


<dt>qGraph</dt>
<dd><p>logical. Plot the network plot based on Vst values
(see details)</p></dd>


<dt>verbose</dt>
<dd><p>logical. show progress</p></dd>


<dt>...</dt>
<dd><p>additional arguments passed to <code>qgraph</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns a matrix of pairwise Vst values for populations</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Vst is calculated with the following equation
$$V_{T} = \frac{ V_{S} }{V_{T}}$$ where VT is the variance of normalized
read depths among all individuals from the two populations and VS is the
average of the variance within each population, weighed for population size
(see reference for more details)
See <code>qgraph</code> help for details on qgraph output</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Redon, Richard, et al. Global variation in copy number in the human genome.
nature 444.7118 (2006)</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Piyal Karunarathne</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">alleleINF</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ADtable</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DD</span><span class="op">&lt;-</span><span class="fu"><a href="dupGet.html">dupGet</a></span><span class="op">(</span><span class="va">alleleINF</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> categorizing deviant SNPs with </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  excess of heterozygotes z.all &amp; chi.all</span>
<span class="r-plt img"><img src="vst-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">ds</span><span class="op">&lt;-</span><span class="va">DD</span><span class="op">[</span><span class="va">DD</span><span class="op">$</span><span class="va">dup.stat</span><span class="op">==</span><span class="st">"duplicated"</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">ad</span><span class="op">&lt;-</span><span class="va">ADtable</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ds</span><span class="op">$</span><span class="va">CHROM</span>,<span class="st">"."</span>,<span class="va">ds</span><span class="op">$</span><span class="va">POS</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ADtable</span><span class="op">$</span><span class="va">CHROM</span>,<span class="st">"."</span>,<span class="va">ADtable</span><span class="op">$</span><span class="va">POS</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">vst</span><span class="op">(</span><span class="va">ad</span>,pops<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ad</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="fl">1</span>,<span class="fl">11</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                          |                                                  |   0%  |                                                          |                                                  |   1%  |                                                          |=                                                 |   2%  |                                                          |=                                                 |   3%  |                                                          |==                                                |   4%  |                                                          |==                                                |   5%  |                                                          |===                                               |   6%  |                                                          |===                                               |   7%  |                                                          |====                                              |   8%  |                                                          |====                                              |   9%  |                                                          |=====                                             |  10%  |                                                          |======                                            |  11%  |                                                          |======                                            |  12%  |                                                          |=======                                           |  13%  |                                                          |=======                                           |  14%  |                                                          |========                                          |  15%  |                                                          |========                                          |  16%  |                                                          |=========                                         |  17%  |                                                          |=========                                         |  18%  |                                                          |==========                                        |  19%  |                                                          |==========                                        |  20%  |                                                          |==========                                        |  21%  |                                                          |===========                                       |  22%  |                                                          |===========                                       |  23%  |                                                          |============                                      |  24%  |                                                          |============                                      |  25%  |                                                          |=============                                     |  26%  |                                                          |=============                                     |  27%  |                                                          |==============                                    |  28%  |                                                          |==============                                    |  29%  |                                                          |===============                                   |  30%  |                                                          |================                                  |  31%  |                                                          |================                                  |  32%  |                                                          |=================                                 |  33%  |                                                          |=================                                 |  34%  |                                                          |==================                                |  35%  |                                                          |==================                                |  36%  |                                                          |===================                               |  37%  |                                                          |===================                               |  38%  |                                                          |====================                              |  39%  |                                                          |====================                              |  40%  |                                                          |====================                              |  41%  |                                                          |=====================                             |  42%  |                                                          |=====================                             |  43%  |                                                          |======================                            |  44%  |                                                          |======================                            |  45%  |                                                          |=======================                           |  46%  |                                                          |=======================                           |  47%  |                                                          |========================                          |  48%  |                                                          |========================                          |  49%  |                                                          |=========================                         |  50%  |                                                          |==========================                        |  51%  |                                                          |==========================                        |  52%  |                                                          |===========================                       |  53%  |                                                          |===========================                       |  54%  |                                                          |============================                      |  55%  |                                                          |============================                      |  56%  |                                                          |=============================                     |  57%  |                                                          |=============================                     |  58%  |                                                          |==============================                    |  59%  |                                                          |==============================                    |  60%  |                                                          |==============================                    |  61%  |                                                          |===============================                   |  62%  |                                                          |===============================                   |  63%  |                                                          |================================                  |  64%  |                                                          |================================                  |  65%  |                                                          |=================================                 |  66%  |                                                          |=================================                 |  67%  |                                                          |==================================                |  68%  |                                                          |==================================                |  69%  |                                                          |===================================               |  70%  |                                                          |====================================              |  71%  |                                                          |====================================              |  72%  |                                                          |=====================================             |  73%  |                                                          |=====================================             |  74%  |                                                          |======================================            |  75%  |                                                          |======================================            |  76%  |                                                          |=======================================           |  77%  |                                                          |=======================================           |  78%  |                                                          |========================================          |  79%  |                                                          |========================================          |  80%  |                                                          |========================================          |  81%  |                                                          |=========================================         |  82%  |                                                          |=========================================         |  83%  |                                                          |==========================================        |  84%  |                                                          |==========================================        |  85%  |                                                          |===========================================       |  86%  |                                                          |===========================================       |  87%  |                                                          |============================================      |  88%  |                                                          |============================================      |  89%  |                                                          |=============================================     |  90%  |                                                          |==============================================    |  91%  |                                                          |==============================================    |  92%  |                                                          |===============================================   |  93%  |                                                          |===============================================   |  94%  |                                                          |================================================  |  95%  |                                                          |================================================  |  96%  |                                                          |================================================= |  97%  |                                                          |================================================= |  98%  |                                                          |==================================================|  99%  |                                                          |==================================================| 100%</span>
<span class="r-plt img"><img src="vst-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             KKOGR07_000 KKOGR07_001 KKOGR07_002 KKOGR07_003 KKOGR07_004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_000          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_001         NaN          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_002         NaN         NaN          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_003         NaN         NaN         NaN          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_004         NaN         NaN         NaN         NaN          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_005         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_006         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_000         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_001         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_002         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_003         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_004         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_005         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_006         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_007         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             KKOGR07_005 KKOGR07_006 KKOKT10_000 KKOKT10_001 KKOKT10_002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_000          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_001          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_002          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_003          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_004          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_005          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_006         NaN          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_000         NaN         NaN          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_001         NaN         NaN         NaN          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_002         NaN         NaN         NaN         NaN          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_003         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_004         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_005         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_006         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_007         NaN         NaN         NaN         NaN         NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             KKOKT10_003 KKOKT10_004 KKOKT10_005 KKOKT10_006 KKOKT10_007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_000          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_001          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_002          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_003          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_004          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_005          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOGR07_006          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_000          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_001          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_002          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_003          NA          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_004         NaN          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_005         NaN         NaN          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_006         NaN         NaN         NaN          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKOKT10_007         NaN         NaN         NaN         NaN          NA</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Piyal Karunarathne, Qiujie Zhou, Klaus Schliep, Pascal Milesi.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

